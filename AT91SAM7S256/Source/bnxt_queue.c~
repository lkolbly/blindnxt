#include "bnxt_queue.h"

void bnxtQueueInit(BNXT_QUEUE *queue)
{
  queue->start = 0;
  queue->end = 0;
}

void bnxtQueuePush(BNXT_QUEUE *queue, BNXT_QUEUE_TYPE val)
{
  queue->end++;
  if (queue->end >= BNXT_QUEUE_BUFFER_SIZE)
    queue->end -= BNXT_QUEUE_BUFFER_SIZE;
  queue->buffer[queue->end] = val;
}


BNXT_QUEUE_TYPE bnxtQueuePop(BNXT_QUEUE *queue)
{
  BNXT_QUEUE_TYPE ret = queue->buffer[queue->start];
  queue->start++;
  if (queue->start >= BNXT_QUEUE_BUFFER_SIZE)
    queue->start -= BNXT_QUEUE_BUFFER_SIZE;
  return ret;
}

BNXT_QUEUE_TYPE bnxtQueuePeek(BNXT_QUEUE *queue)
{
  return queue->buffer[queue->start];
}

int bnxtQueueLength(BNXT_QUEUE *queue)
{
  int ret = queue->end - queue->start;
  if (ret < 0)
    ret += BNXT_QUEUE_BUFFER_SIZE;
  return ret;
}
